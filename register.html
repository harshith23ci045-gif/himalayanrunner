<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Himalayan Runners</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="container" style="padding-top: 2rem; padding-bottom: 80px;">
        <div class="glass-card" style="max-width: 500px; margin: 0 auto;">
            <h2 class="mb-3 text-center">Join Himalayan Runners</h2>

            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input name="fullName" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input name="email" type="email" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Phone Number</label>
                    <input name="phone" type="tel" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Aadhaar Number</label>
                    <input name="aadhaar" class="form-input" maxlength="12" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Role</label>
                    <select name="role" class="form-select">
                        <option value="Trekker">Trekker</option>
                        <option value="Trek Guide">Trek Guide</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input name="password" type="password" class="form-input" required>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%;">Register</button>
            </form>

            <p class="mt-2 text-center">
                Already have an account?
                <a href="login.html" style="color: var(--primary); font-weight: bold;">Login</a>
            </p>
        </div>
    </div>

    <!-- Supabase Auth library -->
    
    <!-- Your Supabase client + Auth (module imports) -->
    <script type="module" src="js/supabase-client.js"></script>
    
    <!-- Registration handler -->
    <script type="module">
        import Auth from "./js/auth-handler.js"; 

        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = {
                fullName: e.target.fullName.value,
                email: e.target.email.value,
                phone: e.target.phone.value,
                aadhaar: e.target.aadhaar.value,
                role: e.target.role.value,
                password: e.target.password.value
            };

            const result = await Auth.register(formData);

            if (result.success) {
                alert('Registration successful! Please login.');
                window.location.href = 'login.html';
            } else {
                alert(result.error);
            }
        });
    </script>

</body>

</html>
