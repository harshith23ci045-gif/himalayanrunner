<script type="module">
    import Auth from "./js/auth-handler.js";

    document.getElementById("loginForm").addEventListener("submit", async (e) => {
        e.preventDefault();

        const email = e.target.email.value;
        const password = e.target.password.value;

        const result = await Auth.login(email, password);

        if (!result.success) {
            alert(result.error);
            return;
        }

        // Read role from profile (NOT from user)
        const role = result.profile.role;

        if (role === "Admin") {
            window.location.href = "dashboard-admin.html";
        } else if (role === "Trek Guide") {
            window.location.href = "dashboard-guide.html";
        } else {
            window.location.href = "dashboard-trekker.html";
        }
    });
</script>
